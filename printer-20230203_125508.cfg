[include mainsail.cfg]
#[include pico_adxl345.cfg]
[exclude_object]
#[include klicky-probe.cfg]
#[include Adaptive_Mesh.cfg]
[include sensorless.cfg] 

[mcu]
#serial: /dev/serial/by-id/usb-Klipper_stm32g0b1xx_2A0010001950425937353020-if00 SKR
serial: /dev/serial/by-id/usb-1a86_USB2.0-Serial-if00-port0

[printer]
kinematics: corexy
max_velocity: 300
max_accel: 4000
max_z_velocity: 15
max_z_accel: 45
square_corner_velocity: 6.0

[temperature_sensor raspberry_pi]
sensor_type: temperature_host

[idle_timeout] timeout: 3600

[bltouch]
sensor_pin: ^PD3
control_pin:PB5
x_offset: -33
y_offset: -11
samples_tolerance: .1 #how much of a difference there can be before it triggers a retest, there is a default if you don't specify
samples_tolerance_retries: 3 #how many times you want it to retry before failing.
lift_speed: 20
speed: 20
z_offset: 0

[bed_mesh]
speed: 100
horizontal_move_z: 4
mesh_min: 5, 8
mesh_max: 87, 109
probe_count: 3,3

#####################################################################
#      X/Y Stepper Settings
#####################################################################

[stepper_x]
## Refer to https://docs.vorondesign.com/build/startup/#v0
step_pin: PF0
dir_pin: PF1
endstop_pin: tmc2209_stepper_x:virtual_endstop
enable_pin: !PD7
rotation_distance: 40
microsteps: 32
full_steps_per_rotation: 200                                        # Set to 400 for 0.9° degree stepper motor, 200 is for 1.8° stepper motors
position_endstop: 120#117.9
position_max: 120
position_min: 2
homing_speed: 50                                                   # Can be increased after initial setup, Max 100
homing_retract_dist: 5
homing_positive_dir: true

[stepper_y]
step_pin: PF6
dir_pin: PF7
enable_pin: !PF2
rotation_distance: 40
microsteps: 32
endstop_pin: tmc2209_stepper_y:virtual_endstop
position_endstop: 120
position_max: 120
position_min: 3
homing_speed: 50
homing_retract_dist: 5
homing_positive_dir: true

[stepper_z]
step_pin: PL3
dir_pin: !PL1
enable_pin: !PK0
rotation_distance: 8
microsteps: 32
endstop_pin: probe:z_virtual_endstop
position_max: 120
position_min: -3
#position_endstop: 0
homing_speed: 20                                                    # Can be increased after initial setup, Max 100
second_homing_speed: 3.0
homing_retract_dist: 3.0

[extruder]
step_pin: PA4
dir_pin: !PA6
enable_pin: !PA2
microsteps: 16
rotation_distance: 22.23                                            # See calibrating rotation_distance on extruders doc
gear_ratio: 50:10                                                   # For Mini Afterburner
microsteps: 32
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: PB4
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PK5
min_temp: 0
max_temp: 300
min_extrude_temp: 170
max_extrude_only_distance: 150
max_extrude_cross_section: 0.8
pressure_advance: 0.0                                               # See tuning pressure advance doc
pressure_advance_smooth_time: 0.040
max_extrude_only_distance: 500.0

[heater_bed]
heater_pin: PH5
sensor_type: ATC Semitec 104GT-2
sensor_pin: PK6
smooth_time: 3.0
min_temp: 0
max_temp: 120
#max_power: 0.6                                                     # Only needed for 100w pads				

[fan]
pin: PH6

#####################################################################
#   Homing and Gantry Adjustment Routines
#####################################################################

[idle_timeout]
timeout: 1800


## To be used with BED_SCREWS_ADJUST																	 
[bed_screws]
screw1: 60,5
screw1_name: front middle
screw2: 5,115
screw2_name: back left
screw3: 115,115
screw3_name: back right

[printer]
kinematics: corexy
max_velocity: 300
max_accel: 4000
max_z_velocity: 15
max_z_accel: 45
square_corner_velocity: 6.0

########################################
# TMC UART configuration
########################################

[tmc2209 stepper_x]
uart_pin: PK1
interpolate: True
run_current: 0.5
sense_resistor: 0.110
stealthchop_threshold: 0      # Set to 999999 to turn stealthchop on, and 0 to use spreadcycle
diag_pin: ^PE5       # Set to MCU pin connected to TMC DIAG pin
driver_SGTHRS: 60   # 255 is most sensitive value, 0 is least sensitive

[tmc2209 stepper_y]
uart_pin: PK2
interpolate: True
run_current: 0.5
sense_resistor: 0.110
stealthchop_threshold: 0      # Set to 999999 to turn stealthchop on, and 0 to use spreadcycle
diag_pin: ^PJ1      # Set to MCU pin connected to TMC DIAG pin
driver_SGTHRS: 60  # 255 is most sensitive value, 0 is least sensitive

[tmc2209 stepper_z]
uart_pin: PK3
interpolate: True
run_current: 0.37
sense_resistor: 0.110
stealthchop_threshold: 0      # Set to 999999 to turn stealthchop on, and 0 to use spreadcycle
#diag_pin: ^PD2     # Set to MCU pin connected to TMC DIAG pin
#driver_SGTHRS: 255  # 255 is most sensitive value, 0 is least sensitiv

[tmc2209 extruder]
uart_pin: PK4
interpolate: True
run_current: 0.6
sense_resistor: 0.110
stealthchop_threshold: 0      # Set to 999999 to turn stealthchop on, and 0 to use spreadcycle

#####################################################################
#   Macros
#####################################################################

[homing_override]
axes: xyz
gcode:
  {% set home_all = 'X' not in params and 'Y' not in params and 'Z' not in params %}

  {% if home_all or 'X' in params %}
    _HOME_X
  {% endif %}
  
  {% if home_all or 'Y' in params %}
    _HOME_Y
  {% endif %}
  
  {% if home_all or 'Z' in params %}
    G28 Z
    G1 Z10
  {% endif %}


#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 63.136
#*# pid_ki = 1.482
#*# pid_kd = 672.399
#*# [extruder]
#*# control = pid
#*# pid_kp = 25.987
#*# pid_ki = 1.118
#*# pid_kd = 151.049
